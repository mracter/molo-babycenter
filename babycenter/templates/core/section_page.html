{% extends "base.html" %}

{% load core_tags i18n pagination %}
{% load wagtailcore_tags wagtailimages_tags %}

{% block content %}
  <h1 class="l-indent heading heading{{self.get_effective_extra_style_hints}}">
    {{self.title}}
  </h1>
  {% load_child_articles_for_section self count=13 as articles %}
  <ul class="article-list">
  {% for article in articles %}
    <li class="l-indent l-indent--tall article-list__item article-list__item--category">
    <div class="category__image">
        <a href="{% pageurl article %}">
            {% if article.image %}
                {% image article.image width-80 class="article__image article__image--square"%}
            {% endif %}
        </a>
    </div>

    <div class="category__text">
        <a href="{% pageurl article %}">
            <h3 class="article-list__title article-list__title{{self.get_effective_extra_style_hints}}">{{article.title}}</h3>
        </a>
        <p class="article-list__subtitle">{{article.subtitle}}</p>
        <p class="article__date article__date--italic  f-small">{{self.first_published_at | date:"j F Y"}}</p>
    </div>
    </li>
  {% endfor %}
  </ul>

  {% if articles %}
  <div class="step-links l-indent l-indent--tall">
    {% if articles_paginated.has_previous %}
      <a href="?p={{ articles_paginated.previous_page_number }}">< Prev</a>
    {% endif %}

    {% get_pages articles_paginated as pages %}
    {% for page in pages.start %}
      <a href="?p={{ page }}">{{ page }}</a>
    {% endfor %}
    {% if pages.ellipses_before %}
      ...
    {% endif %}
    {% for page in pages.before_current %}
      <a href="?p={{ page }}">{{ page}}</a>
    {% endfor %}
    <span class="current">
        {{ articles_paginated.number }}
    </span>
    {% for page in pages.after_current %}
      <a href="?p={{ page }}">{{ page }}</a>
    {% endfor %}
    {% if pages.ellipses_after %}
      ...
    {% endif %}
    {% for page in pages.end %}
      <a href="?p={{ page }}">{{ page }}</a>
    {% endfor %}

    {% if articles_paginated.has_next %}
        <a href="?p={{ articles_paginated.next_page_number }}">Next ></a>
    {% endif %}
  </div>
  {% endif %}

{% endblock %}
