{% extends "base.html" %}

{% load core_tags i18n molo_survey_tags pagination %}
{% load wagtailcore_tags wagtailimages_tags %}

{% block content %}


	<h1 class="heading heading{{self.get_effective_extra_style_hints}}">
		{{self.title}}
	</h1>

	{% load_child_articles_for_section self count=2 as articles %}
	<ul class="article-list">
	{% for article in articles %}
		<li class="article-list__item article-list__item--category">
			<a href="{% pageurl article %}">
					{% if article.image %}
					<div class="article-list__image">
						{% image article.image width-45 height-45  %}
					</div>
					{% endif %}
					<h2 class="article-list__title">{{article.title}}</h2>
					<h4 class="article-list__subtitle">{{article.subtitle}}</h4>
					<p class="article__date f-small">{{self.first_published_at | date:"j F Y"}}</p>
			</a>
		</li>
	{% endfor %}
	</ul>

	{% if articles %}
	<div class="pagination">
		{% if articles_paginated.has_previous %}
			<a href="?p={{ articles_paginated.previous_page_number }}">< Prev</a>
		{% endif %}

		{% get_pages articles_paginated as pages %}
		
		{% for page in pages.start %}
			<a href="?p={{ page }}">{{ page }}</a>
		{% endfor %}
		

		{% if pages.ellipses_before %}
			...
		{% endif %}
		{% for page in pages.before_current %}
			<a href="?p={{ page }}">{{ page}}</a>
		{% endfor %}
		<span class="current">
				{% if articles_paginated.has_next %}
					{{ articles_paginated.number }}
				{% endif %}
		</span>
		{% for page in pages.after_current %}
			<a href="?p={{ page }}">{{ page }}</a>
		{% endfor %}
		{% if pages.ellipses_after %}
			...
		{% endif %}
		
		{% for page in pages.end %}
			<a href="?p={{ page }}">{{ page }}</a>
		{% endfor %}
		
		{% if articles_paginated.has_next %}
				<a href="?p={{ articles_paginated.next_page_number }}">Next ></a>
		{% endif %}
	</div>
	{% endif %}

{% load_child_sections_for_section self as sections %}
{% if sections %}
	<ul class="subsection-list subsection-list{{self.get_effective_extra_style_hints}}">
	{% for section in sections %}
		<li class="subsection-list__item">
			<a href="{% pageurl section %}" class="subsection-list__title">{{section.title}}</a>
		</li>
	{% endfor %}
	</ul>
{% endif %}

{% surveys_list_for_pages page=self %}

{% endblock %}
